<!DOCTYPE html>
<html>
<head>
    <title>Background Motion Task</title>

            <!-- jQuery -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js" integrity="sha256-VazP97ZCwtekAsvgPBSUwPFKdrwD3unUfSGVYrahUqU=" crossorigin="anonymous"></script>
    <!-- css -->
    <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
    <link href="https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css" rel="stylesheet" type="text/css">
    <!-- SVG.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/svg.js/2.6.3/svg.min.js"></script>

    <script src="../jspsych-6.0.5/jspsych.js"></script>
    <script src="../jspsych-6.0.5/plugins/jspsych-html-keyboard-response.js"></script>
    <script src=../jspsych-6.0.5/plugins/jspsych-image-keyboard-response.js"></script>
    <link href="../jspsych-6.0.5/css/jspsych.css" rel="stylesheet" type="text/css"></link>
    <script src="../jspsych-6.0.5/plugins/jspsych-fullscreen.js"></script>
    <script src="../jspsych-6.0.5/plugins/jspsych-survey-text.js"></script>
    <script src="../jspsych-6.0.5/plugins/jspsych-instructions.js"></script>
      <script src="jspsych-virtual-chinrest.js"></script>
      <script src="jspsych-rdk_2.js"></script>
      <script src="jspsych-ydk.js"></script>

</head>
<body>
</body>
<script>

function saveData() {
  var xhr = new XMLHttpRequest();
  xhr.open('POST', 'write_data.php'); // change 'write_data.php' to point to php script.
  xhr.setRequestHeader('Content-Type', 'application/json');
  xhr.onload = function() {
    if(xhr.status == 200){
      var response = JSON.parse(xhr.responseText);
      console.log(response.success);
    }
  };
  xhr.send(jsPsych.data.get().json());
}

var virtual_chinrest_trial = {
type: 'virtual-chinrest',
resize_units: "deg",
blindspot_reps: 1,
pixels_per_unit: 190,
};

/*set up instructions block*/
var instructions = {
  type: "instructions",
  pages: [ "<p>This is backgroung motion experiment, like the examples below.</p>"
    ],
    show_clickable_nav:true
};


var test_block = {
  type: "rdk_2", 
  aperture_type: 2,
  number_of_apertures: 1, //This needs to be set if more than one aperture
  trial_duration: 1000,
  RDK_type: 3, //Applied to all apertures if only one value
  aperture_width: 100, //Applied to all apertures if only one value
  number_of_dots: 100, //Different parameter for each aperture. Array length must equal number_of_apertures
  aperture_center_x: [window.innerWidth/2], //Separate the apertures on the screen (window.innerWidth/2 is the middle of the screen),
  coherence: 0.3,
  move_distance: 1,
  number_of_dots: 100,
  foreground_aperture_width: 500,
  foreground_aperture_height: 500,
  foreground_number_of_dots: 200,
  foreground_move_distance: 0.6, //Different parameter for each aperture. Array length must equal number_of_apertures
  foreground_aperture_center_x: [(window.innerWidth/2)-200,(window.innerWidth/2)+200],
  foreground_number_of_apertures: 1
};

  /*set up experiment structure*/
  var timeline = [];
  timeline.push(instructions);
  timeline.push(test_block);

  /*start experiment*/
  jsPsych.init({
      timeline: timeline,
      // show_progress_bar: true,
      on_finish: saveData
  });
</script>
</html>